<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Buffered Voronoi Cell Collision Avoidance Demo</title>
  <link rel="stylesheet" href="stylesheets/styles.css">
</head>
<body>
  <svg width="1400" height="600"></svg>
  <div class="options">
    <div class="ui-section">
      <label class="key">Unique Collisions:</label>
      <input type="text" class="input-text input" id="unique-collisions" disabled>
    </div>
    <div class="ui-section">
      <label class="key">Total Collisions-Time Instances:</label>
      <input type="text" class="input-text input" id="total-collisions" disabled>
    </div>
    <div class="ui-section">
      <label class="key">Timescale:</label>
      <input type="range" min="0.0001" max="1.0" value=".005" step="0.001" class="slider input" id="time-scale-slider">
    </div>
    <div class="ui-section">
      <label class="key">Robots:</label>
      <input type="range" min="2" max="50" value="10" step="1" class="slider input" id="robots-slider">
    </div>
    <div class="ui-section">
      <label class="key">Montion Planning Algorithm:</label>
      <select class="input-select input" id="algorithm-select" name="algorithms">
        <!-- <option value="0">Random</option> -->
        <option value="1">None (Straight To Goal)</option>
        <option value="2">Voronoi Cell</option>
        <option value="3" selected>Buffered Voronoi Cell</option>
      </select>
    </div>
    <div class="ui-section">
      <label class="key">Reset:</label>
      <input type="button" value="Reset" class="input-button input" id="reset-button" onclick="resetSimulation()">
    </div>
    <div class="ui-section">
      <label class="key">Pause:</label>
      <input type="button" value="Pause" class="input-button input" id="reset-button" onclick="pauseSimulation()">
    </div>
  </div>

  <script src="https://d3js.org/d3.v4.js"></script>
  <script src="libraries/d3-delaunay.js"></script>
  <script src="scripts/geometry.js"></script>
  <script src="scripts/renderer.js"></script>
  <script src="scripts/scene.js"></script>
  <script src="scripts/robot.js"></script>
</body>
</html>

<!DOCTYPE html>
<meta charset="utf-8">
<script>
// var res = shiftLineSegInDirOfPerpendicularBisector(0,0,1,1);
// console.log(res);
// throw new Error("Something went badly wrong!");

// Setup
var paused = false;
var numberOfRobots = 2;
var radiusOfRobots = 10;
var svg = d3.select("svg");
let motionPlanningAlgorithm = parseInt(document.getElementById("algorithm-select").value);
var gScene = new Scene(svg, numberOfRobots, radiusOfRobots, motionPlanningAlgorithm);

var resetSimulation = function(){
  svg.selectAll("*").remove();
  motionPlanningAlgorithm = parseInt(document.getElementById("algorithm-select").value);
  gScene = new Scene(svg, numberOfRobots, radiusOfRobots, motionPlanningAlgorithm);
}

var pauseSimulation= function(){
  paused = !paused;
}

var renderScene = function(){
  if(!paused){
    gScene.update();  
  }

  numberOfRobots = document.getElementById("robots-slider").value;
  gScene.setTimeScale(document.getElementById("time-scale-slider").value);
  document.getElementById("unique-collisions").value = gScene.uniqueCollisions.length;
  document.getElementById("total-collisions").value = gScene.totalCollisionTimeInst;

  requestAnimationFrame(renderScene);
}

renderScene();

</script>
